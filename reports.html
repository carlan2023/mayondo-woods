<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reports - MWF</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Playfair+Display:wght@600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Poppins", sans-serif;
        background-color: #f8f9fa;
      }
      .brand-title {
        font-family: "Playfair Display", serif;
        color: #ff6219;
      }
      .btn-primary {
        background-color: #ff6219 !important;
        border: none !important;
      }
      .card {
        border: none;
        border-radius: 1rem;
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
      <div class="container">
        <a class="navbar-brand brand-title" href="index.html">MWF Ltd</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="dashboard.html">Dashboard</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="inventory.html">Inventory</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="sales.html">Sales</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="reports.html">Reports</a>
            </li>
            <li class="nav-item">
              <a class="btn btn-primary ms-2" href="login.html">Logout</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Reports Section -->
    <section class="container py-5">
      <h2 class="brand-title text-center mb-5">Reports Center</h2>

      <!-- Filters -->
      <div class="card shadow-lg p-4 mb-4">
        <form id="reportForm" class="row g-3 align-items-end">
          <div class="col-md-4">
            <label class="form-label">Report Type</label>
            <select id="reportType" class="form-select" required>
              <option value="sales">Sales Report</option>
              <option value="inventory">Inventory Report</option>
              <option value="orders">Orders Report</option>
            </select>
          </div>
          <div class="col-md-3">
            <label class="form-label">Start Date</label>
            <input type="date" id="startDate" class="form-control" required />
          </div>
          <div class="col-md-3">
            <label class="form-label">End Date</label>
            <input type="date" id="endDate" class="form-control" required />
          </div>
          <div class="col-md-2 text-end">
            <button type="submit" class="btn btn-primary w-100">
              <i class="fas fa-chart-bar"></i> Generate
            </button>
          </div>
        </form>
      </div>

      <!-- Report Table -->
      <div class="card shadow-lg p-4">
        <div class="d-flex justify-content-between mb-3">
          <h5 id="reportTitle">Sales Report</h5>
          <button class="btn btn-outline-primary btn-sm" id="exportBtn">
            <i class="fas fa-file-export"></i> Export
          </button>
        </div>
        <div class="table-responsive">
          <table class="table table-striped table-hover" id="reportTable">
            <thead class="table-dark">
              <tr id="reportHead"></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <script>
      const form = document.getElementById("reportForm");
      const reportTitle = document.getElementById("reportTitle");
      const reportHead = document.getElementById("reportHead");
      const reportTable = document.querySelector("#reportTable tbody");

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        const type = document.getElementById("reportType").value;
        const start = document.getElementById("startDate").value;
        const end = document.getElementById("endDate").value;

        reportTable.innerHTML = ""; // clear table

        if (type === "sales") {
          reportTitle.textContent = `Sales Report (${start} - ${end})`;
          reportHead.innerHTML = `
            <th>Customer</th><th>Product</th><th>Qty</th><th>Total</th><th>Payment</th><th>Agent</th><th>Date</th>
          `;
          // Dummy data (replace with backend fetch)
          const data = [
            {
              customer: "Allan",
              product: "Chair",
              qty: 2,
              total: 240,
              payment: "Cash",
              agent: "John",
              date: "2025-08-15",
            },
            {
              customer: "Sarah",
              product: "Table",
              qty: 1,
              total: 450,
              payment: "Cheque",
              agent: "Mary",
              date: "2025-08-16",
            },
          ];
          data.forEach((d) => {
            const row = `<tr>
              <td>${d.customer}</td><td>${d.product}</td><td>${d.qty}</td><td>$${d.total}</td><td>${d.payment}</td><td>${d.agent}</td><td>${d.date}</td>
            </tr>`;
            reportTable.insertAdjacentHTML("beforeend", row);
          });
        } else if (type === "inventory") {
          reportTitle.textContent = `Inventory Report (${start} - ${end})`;
          reportHead.innerHTML = `
            <th>Product</th><th>Type</th><th>Supplier</th><th>Qty</th><th>Cost</th><th>Price</th><th>Date</th>
          `;
          const data = [
            {
              product: "Cabinet",
              type: "Furniture",
              supplier: "Kampala Wood",
              qty: 15,
              cost: 180,
              price: 300,
              date: "2025-08-10",
            },
            {
              product: "Timber",
              type: "Wood",
              supplier: "Mbarara Suppliers",
              qty: 200,
              cost: 20,
              price: 35,
              date: "2025-08-12",
            },
          ];
          data.forEach((d) => {
            const row = `<tr>
              <td>${d.product}</td><td>${d.type}</td><td>${d.supplier}</td><td>${d.qty}</td><td>$${d.cost}</td><td>$${d.price}</td><td>${d.date}</td>
            </tr>`;
            reportTable.insertAdjacentHTML("beforeend", row);
          });
        } else if (type === "orders") {
          reportTitle.textContent = `Orders Report (${start} - ${end})`;
          reportHead.innerHTML = `
            <th>Order ID</th><th>Customer</th><th>Total</th><th>Status</th><th>Date</th>
          `;
          const data = [
            {
              id: 101,
              customer: "Moses",
              total: 600,
              status: "Pending",
              date: "2025-08-17",
            },
            {
              id: 102,
              customer: "Jane",
              total: 1200,
              status: "Delivered",
              date: "2025-08-18",
            },
          ];
          data.forEach((d) => {
            const row = `<tr>
              <td>${d.id}</td><td>${d.customer}</td><td>$${d.total}</td><td>${d.status}</td><td>${d.date}</td>
            </tr>`;
            reportTable.insertAdjacentHTML("beforeend", row);
          });
        }
      });

      // Export function (CSV for now)
      document.getElementById("exportBtn").addEventListener("click", () => {
        const rows = [["Report Export"], []];
        const headers = Array.from(
          document.querySelectorAll("#reportHead th")
        ).map((th) => th.textContent);
        rows.push(headers);
        document.querySelectorAll("#reportTable tbody tr").forEach((tr) => {
          const cells = Array.from(tr.children).map((td) => td.textContent);
          rows.push(cells);
        });

        const csv = rows.map((r) => r.join(",")).join("\\n");
        const blob = new Blob([csv], { type: "text/csv" });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "report.csv";
        a.click();
      });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
